<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ú® My girly routine ‚ú®</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Organizando mi vida but make it pink">
    <meta name="theme-color" content="#ff99cc">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Girly Routine">
    <link rel="manifest" href="./manifest.json">
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23ff9ec8;stop-opacity:1' /%3E%3Cstop offset='50%25' style='stop-color:%23ffb3d9;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23ff99cc;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='200' height='200' rx='40' fill='url(%23grad)'/%3E%3Ctext x='100' y='120' font-size='100' text-anchor='middle' fill='white' font-family='sans-serif'%3E‚ú®%3C/text%3E%3C/svg%3E">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #ffeef8 0%, #ffe4f3 25%, #ffd4f0 50%, #ffe8f5 75%, #fff0f8 100%);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Decoraciones kawaii de fondo */
        body::before {
            content: "‚ú®";
            position: fixed;
            font-size: 3em;
            top: 10%;
            left: 5%;
            opacity: 0.3;
            animation: float 3s ease-in-out infinite;
        }

        body::after {
            content: "üå∏";
            position: fixed;
            font-size: 2.5em;
            top: 70%;
            right: 8%;
            opacity: 0.3;
            animation: float 4s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .sparkle {
            position: fixed;
            font-size: 1.5em;
            opacity: 0.2;
            pointer-events: none;
            animation: float 5s ease-in-out infinite;
        }

        .sparkle:nth-child(1) { top: 20%; left: 15%; animation-delay: 0s; }
        .sparkle:nth-child(2) { top: 50%; right: 20%; animation-delay: 1s; }
        .sparkle:nth-child(3) { top: 80%; left: 25%; animation-delay: 2s; }

        .container {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeIn 0.8s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header h1 {
            font-size: 3em;
            background: linear-gradient(135deg, #ff9ec8, #ffb3d9, #ff99cc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(255, 182, 217, 0.3);
        }

        .header p {
            font-size: 1.2em;
            color: #ff99cc;
            font-weight: 500;
        }

        .main-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(255, 182, 217, 0.4);
            overflow: hidden;
            border: 3px solid #ffe4f3;
            backdrop-filter: blur(10px);
        }

        .tabs {
            display: flex;
            background: linear-gradient(135deg, #ffe4f3, #fff0f8);
            border-bottom: 3px solid #ffb3d9;
            padding: 10px;
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: #ff99cc;
            transition: all 0.3s;
            border-radius: 20px;
            margin: 0 5px;
            font-size: 1.1em;
        }

        .tab:hover {
            background: rgba(255, 182, 217, 0.3);
            transform: translateY(-2px);
        }

        .tab.active {
            background: linear-gradient(135deg, #ff9ec8, #ffb3d9);
            color: white;
            box-shadow: 0 5px 15px rgba(255, 158, 200, 0.4);
        }

        .content {
            padding: 30px;
        }

        .task-form {
            background: linear-gradient(135deg, #fff0f8, #ffe8f5);
            padding: 30px;
            border-radius: 25px;
            margin-bottom: 30px;
            border: 3px solid #ffb3d9;
            box-shadow: 0 10px 30px rgba(255, 182, 217, 0.2);
        }

        .form-title {
            font-size: 1.8em;
            color: #ff99cc;
            margin-bottom: 25px;
            font-weight: 700;
            text-align: center;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-weight: 600;
            margin-bottom: 10px;
            color: #ff66b3;
            font-size: 1em;
        }

        input, select, textarea {
            padding: 15px;
            border: 3px solid #ffe4f3;
            border-radius: 15px;
            font-size: 1em;
            transition: all 0.3s;
            font-family: 'Quicksand', sans-serif;
            background: white;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #ffb3d9;
            box-shadow: 0 0 0 4px rgba(255, 182, 217, 0.2);
            transform: translateY(-2px);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            padding: 15px 35px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-family: 'Quicksand', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff9ec8, #ffb3d9, #ff99cc);
            color: white;
            width: 100%;
            box-shadow: 0 10px 25px rgba(255, 158, 200, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(255, 158, 200, 0.6);
        }

        .btn-primary:active {
            transform: translateY(-1px);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9em;
            border-radius: 15px;
        }

        .btn-edit {
            background: linear-gradient(135deg, #ffd4f0, #ffe4f3);
            color: #ff66b3;
            border: 2px solid #ffb3d9;
        }

        .btn-edit:hover {
            background: linear-gradient(135deg, #ffb3d9, #ffd4f0);
            transform: translateY(-2px);
        }

        .btn-delete {
            background: linear-gradient(135deg, #ffcce0, #ffd4e8);
            color: #ff3385;
            border: 2px solid #ff99cc;
        }

        .btn-delete:hover {
            background: linear-gradient(135deg, #ff99cc, #ffb3d9);
            transform: translateY(-2px);
        }

        .filters {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-btn {
            padding: 10px 20px;
            border: 3px solid #ffe4f3;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
            font-weight: 600;
            color: #ff99cc;
            font-family: 'Quicksand', sans-serif;
        }

        .filter-btn:hover {
            border-color: #ffb3d9;
            background: #fff0f8;
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #ff9ec8, #ffb3d9);
            color: white;
            border-color: #ff9ec8;
            box-shadow: 0 5px 15px rgba(255, 158, 200, 0.4);
        }

        .tasks-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .task-card {
            background: white;
            border: 3px solid #ffe4f3;
            border-radius: 20px;
            padding: 25px;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 5px 15px rgba(255, 182, 217, 0.15);
        }

        .task-card:hover {
            box-shadow: 0 10px 30px rgba(255, 182, 217, 0.3);
            transform: translateY(-3px);
            border-color: #ffb3d9;
        }

        .task-card.completed {
            background: linear-gradient(135deg, #fff0f8, #ffe8f5);
            opacity: 0.7;
        }

        .task-card.completed .task-title {
            text-decoration: line-through;
            color: #ff99cc;
        }

        .task-header {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 15px;
        }

        .task-checkbox {
            width: 28px;
            height: 28px;
            cursor: pointer;
            flex-shrink: 0;
            margin-top: 2px;
            accent-color: #ff99cc;
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #ff66b3;
            margin-bottom: 12px;
        }

        .task-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 12px;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            border: 2px solid;
        }

        .badge-high {
            background: linear-gradient(135deg, #ffcce0, #ffd4e8);
            color: #ff3385;
            border-color: #ff99cc;
        }

        .badge-medium {
            background: linear-gradient(135deg, #fff0d4, #fff5e0);
            color: #ff9966;
            border-color: #ffcc99;
        }

        .badge-low {
            background: linear-gradient(135deg, #d4f0ff, #e0f5ff);
            color: #6699ff;
            border-color: #99ccff;
        }

        .badge-category {
            background: linear-gradient(135deg, #ffe4f3, #fff0f8);
            color: #ff66b3;
            border-color: #ffb3d9;
        }

        .badge-deadline {
            background: linear-gradient(135deg, #f0e4ff, #f5e8ff);
            color: #9966ff;
            border-color: #cc99ff;
        }

        .badge-deadline.overdue {
            background: linear-gradient(135deg, #ffcce0, #ffd4e8);
            color: #ff3385;
            border-color: #ff99cc;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .badge-reminder {
            background: linear-gradient(135deg, #ffe8cc, #fff0d4);
            color: #ff9966;
            border-color: #ffcc99;
        }

        .task-notes {
            color: #ff99cc;
            font-size: 1em;
            line-height: 1.6;
            margin-top: 12px;
            padding: 15px;
            background: linear-gradient(135deg, #fff0f8, #ffe8f5);
            border-radius: 15px;
            border: 2px solid #ffe4f3;
        }

        .task-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: #ff99cc;
        }

        .empty-state-icon {
            font-size: 5em;
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
        }

        .empty-state h3 {
            font-size: 2em;
            margin-bottom: 15px;
            color: #ff66b3;
            font-weight: 700;
        }

        .empty-state p {
            font-size: 1.2em;
            font-weight: 500;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #ff9ec8, #ffb3d9, #ff99cc);
            color: white;
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(255, 158, 200, 0.4);
            border: 3px solid rgba(255, 255, 255, 0.3);
            text-align: center;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(255, 158, 200, 0.6);
        }

        .stat-value {
            font-size: 3.5em;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .stat-label {
            font-size: 1.1em;
            font-weight: 600;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff9ec8, #ffb3d9);
            color: white;
            padding: 20px 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(255, 158, 200, 0.5);
            z-index: 1000;
            animation: slideIn 0.5s ease-out;
            border: 3px solid rgba(255, 255, 255, 0.5);
            font-weight: 600;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .header p {
                font-size: 0.95em;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                font-size: 0.95em;
                padding: 12px;
            }

            .form-title {
                font-size: 1.3em;
            }

            .task-title {
                font-size: 1.05em;
            }

            .task-actions {
                flex-direction: column;
            }

            .stat-value {
                font-size: 2.2em;
            }

            .stat-label {
                font-size: 0.9em;
            }

            label {
                font-size: 0.85em;
            }

            input, select, textarea {
                font-size: 0.95em;
                padding: 10px;
            }

            .btn {
                font-size: 0.95em;
                padding: 12px 25px;
            }

            .btn-small {
                font-size: 0.85em;
                padding: 6px 12px;
            }

            .badge {
                font-size: 0.8em;
                padding: 6px 10px;
            }

            .task-notes {
                font-size: 0.9em;
            }

            .notebook-title {
                font-size: 1.3em;
            }

            .notebook-date {
                font-size: 0.85em;
            }

            .notebook-textarea {
                font-size: 0.95em;
                line-height: 35px;
            }

            .notebook-pages {
                padding: 20px 15px 20px 35px;
            }

            .notebook-header {
                padding: 15px 15px;
            }

            .notebook-footer {
                padding: 12px 15px;
            }

            .notebook::before {
                left: 25px;
            }

            .chart-title {
                font-size: 1.2em;
            }

            .bar-label {
                font-size: 0.9em;
                min-width: 110px;
            }

            .bar-fill {
                font-size: 0.9em;
            }

            .bar-value {
                font-size: 0.95em;
            }

            .content {
                padding: 20px;
            }

            .task-form {
                padding: 20px;
            }

            .empty-state h3 {
                font-size: 1.3em;
            }

            .empty-state p {
                font-size: 1em;
            }

            .filter-btn {
                font-size: 0.85em;
                padding: 8px 14px;
            }

            .word-count {
                font-size: 0.9em;
            }

            .note-title-input {
                font-size: 1.1em;
            }

            .note-date {
                font-size: 0.8em;
            }

            .note-content {
                font-size: 0.9em;
            }

            .new-note-btn {
                font-size: 1em;
                padding: 12px 25px;
            }

            .mode-btn {
                font-size: 0.9em;
                padding: 8px 16px;
            }

            .lists-categories {
                grid-template-columns: 1fr;
            }

            .list-category-title {
                font-size: 1.1em;
            }

            .list-category-icon {
                font-size: 1.5em;
            }

            .list-item-text {
                font-size: 0.9em;
            }

            .add-item-input {
                font-size: 0.9em;
            }
        }

        /* Custom select styling */
        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23ff99cc' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            padding-right: 40px;
        }

        .category-beauty { border-left: 5px solid #ff99cc; }
        .category-code { border-left: 5px solid #9966ff; }
        .category-cafe { border-left: 5px solid #ff9966; }
        .category-study { border-left: 5px solid #66ccff; }
        .category-workout { border-left: 5px solid #ff66b3; }
        .category-shopping { border-left: 5px solid #ffb366; }
        .category-otros { border-left: 5px solid #b3b3ff; }

        .charts-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 3px solid #ffe4f3;
        }

        .chart-container {
            background: white;
            border: 3px solid #ffe4f3;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(255, 182, 217, 0.15);
        }

        .chart-title {
            font-size: 1.5em;
            color: #ff66b3;
            margin-bottom: 25px;
            font-weight: 700;
            text-align: center;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .bar-label {
            min-width: 150px;
            font-weight: 600;
            color: #ff66b3;
            font-size: 1.1em;
        }

        .bar-wrapper {
            flex: 1;
            background: linear-gradient(135deg, #fff0f8, #ffe8f5);
            border-radius: 15px;
            height: 40px;
            position: relative;
            overflow: hidden;
            border: 2px solid #ffe4f3;
        }

        .bar-fill {
            height: 100%;
            border-radius: 13px;
            transition: width 1s ease-out;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 15px;
            color: white;
            font-weight: 700;
            font-size: 1em;
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.3);
        }

        .bar-beauty { background: linear-gradient(135deg, #ff99cc, #ffb3d9); }
        .bar-code { background: linear-gradient(135deg, #9966ff, #b399ff); }
        .bar-cafe { background: linear-gradient(135deg, #ff9966, #ffb399); }
        .bar-study { background: linear-gradient(135deg, #66ccff, #99ddff); }
        .bar-workout { background: linear-gradient(135deg, #ff66b3, #ff99cc); }
        .bar-shopping { background: linear-gradient(135deg, #ffb366, #ffcc99); }
        .bar-otros { background: linear-gradient(135deg, #b3b3ff, #ccccff); }

        .bar-value {
            min-width: 50px;
            text-align: right;
            font-weight: 700;
            color: #ff66b3;
            font-size: 1.1em;
        }

        @keyframes barGrow {
            from { width: 0; }
        }

        /* Notebook Styles */
        .notebook-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .notebook {
            background: white;
            border-radius: 15px;
            padding: 0;
            box-shadow: 0 10px 30px rgba(255, 182, 217, 0.3);
            border: 3px solid #ffe4f3;
            overflow: hidden;
            position: relative;
        }

        .notebook::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #ffb3d9 0%, #ffb3d9 50%, transparent 50%, transparent 100%);
            background-size: 2px 20px;
            opacity: 0.2;
        }

        .notebook-header {
            background: linear-gradient(135deg, #ffe4f3, #fff0f8);
            padding: 20px 25px;
            border-bottom: 3px solid #ffb3d9;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 8px;
        }

        .notebook-title {
            font-size: 1.8em;
            color: #ff66b3;
            font-weight: 700;
        }

        .notebook-date {
            font-size: 0.95em;
            color: #ff99cc;
            font-weight: 600;
        }

        .notebook-pages {
            padding: 20px 15px;
            min-height: 500px;
            background: 
                repeating-linear-gradient(
                    transparent,
                    transparent 39px,
                    #ffe4f3 39px,
                    #ffe4f3 40px
                ),
                white;
            position: relative;
        }

        .notebook-textarea {
            width: 100%;
            min-height: 450px;
            border: none;
            outline: none;
            font-family: 'Quicksand', sans-serif;
            font-size: 1.1em;
            line-height: 40px;
            color: #ff66b3;
            background: transparent;
            resize: vertical;
            padding: 0;
        }

        .notebook-textarea::placeholder {
            color: #ffb3d9;
            opacity: 0.6;
        }

        .notebook-footer {
            background: linear-gradient(135deg, #fff0f8, #ffe4f3);
            padding: 15px 20px;
            border-top: 3px solid #ffb3d9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .word-count {
            color: #ff99cc;
            font-weight: 600;
            font-size: 1em;
        }

        .notebook-actions {
            display: flex;
            gap: 10px;
        }

        .note-card {
            background: linear-gradient(135deg, #fff0f8, #ffe8f5);
            border: 3px solid #ffe4f3;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(255, 182, 217, 0.15);
            transition: all 0.3s;
            position: relative;
        }

        .note-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 182, 217, 0.25);
        }

        .note-card-header {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 2px solid #ffe4f3;
            gap: 8px;
        }

        .note-title-input {
            font-size: 1.3em;
            font-weight: 700;
            color: #ff66b3;
            background: transparent;
            border: none;
            outline: none;
            width: 100%;
            font-family: 'Quicksand', sans-serif;
        }

        .note-title-input::placeholder {
            color: #ffb3d9;
            opacity: 0.6;
        }

        .note-date {
            font-size: 0.9em;
            color: #ff99cc;
            font-weight: 600;
        }

        .note-content {
            color: #ff66b3;
            line-height: 1.6;
            font-size: 1em;
            white-space: pre-wrap;
            word-wrap: break-word;
            min-height: 60px;
        }

        .note-content:empty:before {
            content: attr(data-placeholder);
            color: #ffb3d9;
            opacity: 0.6;
        }

        .note-actions-bar {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 2px solid #ffe4f3;
        }

        .notes-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .new-note-btn {
            background: linear-gradient(135deg, #ff9ec8, #ffb3d9, #ff99cc);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 20px rgba(255, 158, 200, 0.4);
            transition: all 0.3s;
            font-family: 'Quicksand', sans-serif;
        }

        .new-note-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(255, 158, 200, 0.6);
        }

        .notebook-mode-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .mode-btn {
            padding: 10px 20px;
            border: 3px solid #ffe4f3;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
            font-weight: 600;
            color: #ff99cc;
            font-family: 'Quicksand', sans-serif;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #ff9ec8, #ffb3d9);
            color: white;
            border-color: #ff9ec8;
        }

        .mode-btn:hover {
            border-color: #ffb3d9;
        }

        /* Lists Section Styles */
        .lists-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .list-category-card {
            background: linear-gradient(135deg, #fff0f8, #ffe8f5);
            border: 3px solid #ffe4f3;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(255, 182, 217, 0.15);
            transition: all 0.3s;
        }

        .list-category-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 182, 217, 0.25);
        }

        .list-category-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #ffe4f3;
        }

        .list-category-icon {
            font-size: 2em;
        }

        .list-category-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #ff66b3;
            flex: 1;
        }

        .list-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .list-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: white;
            border-radius: 12px;
            border: 2px solid #ffe4f3;
            transition: all 0.3s;
        }

        .list-item:hover {
            border-color: #ffb3d9;
        }

        .list-item.checked {
            background: linear-gradient(135deg, #f5f5f5, #fafafa);
            opacity: 0.6;
        }

        .list-item.checked .list-item-text {
            text-decoration: line-through;
            color: #ff99cc;
        }

        .list-item-checkbox {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: #ff99cc;
            flex-shrink: 0;
        }

        .list-item-text {
            flex: 1;
            color: #ff66b3;
            font-weight: 500;
            font-size: 1em;
        }

        .list-item-delete {
            background: transparent;
            border: none;
            color: #ff99cc;
            cursor: pointer;
            font-size: 1.2em;
            padding: 5px;
            opacity: 0.6;
            transition: all 0.3s;
        }

        .list-item-delete:hover {
            opacity: 1;
            transform: scale(1.2);
        }

        .add-item-form {
            display: flex;
            gap: 8px;
            margin-top: 15px;
        }

        .add-item-input {
            flex: 1;
            padding: 10px;
            border: 2px solid #ffe4f3;
            border-radius: 10px;
            font-family: 'Quicksand', sans-serif;
            font-size: 0.95em;
            color: #ff66b3;
        }

        .add-item-input:focus {
            outline: none;
            border-color: #ffb3d9;
        }

        .add-item-input::placeholder {
            color: #ffb3d9;
            opacity: 0.6;
        }

        .add-item-btn {
            background: linear-gradient(135deg, #ff9ec8, #ffb3d9);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 15px;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 700;
        }

        .add-item-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 158, 200, 0.4);
        }

        /* Loader Styles */
        .app-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffeef8 0%, #ffe4f3 25%, #ffd4f0 50%, #ffe8f5 75%, #fff0f8 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.3s ease-out;
        }

        .app-loader.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loader-content {
            text-align: center;
        }

        .loader-icon {
            font-size: 4em;
            margin-bottom: 20px;
            animation: float 2s ease-in-out infinite;
        }

        .loader-text {
            font-size: 1.5em;
            color: #ff66b3;
            font-weight: 700;
            font-family: 'Quicksand', sans-serif;
        }

        .loader-subtext {
            font-size: 1em;
            color: #ff99cc;
            margin-top: 10px;
            font-family: 'Quicksand', sans-serif;
        }
    </style>
</head>
<body>
    <!-- Loader -->
    <div class="app-loader" id="appLoader">
        <div class="loader-content">
            <div class="loader-icon">‚ú®</div>
            <div class="loader-text">Cargando...</div>
            <div class="loader-subtext">Preparando tu rutina girly üíï</div>
        </div>
    </div>

    <div class="sparkle">üí´</div>
    <div class="sparkle">üåü</div>
    <div class="sparkle">‚≠ê</div>

    <div class="container">
        <div class="header">
            <h1>‚ú® My girly routine ‚ú®</h1>
            <p>Organizando mi vida but make it pink üíï</p>
        </div>

        <div class="main-card">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('tasks')">üìù Mis Tareas</div>
                <div class="tab" onclick="switchTab('lists')">üìã Mis Listas</div>
                <div class="tab" onclick="switchTab('notebook')">üìì Mi Cuadernito</div>
                <div class="tab" onclick="switchTab('stats')">üìä Estad√≠sticas</div>
            </div>

            <div class="content">
                <div id="tasks-view">
                    <div class="task-form">
                        <div class="form-title">‚ú® Nueva Tarea ‚ú®</div>
                        <form id="taskForm">
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label>üíñ T√≠tulo de la tarea</label>
                                    <input type="text" id="taskTitle" placeholder="Ej: Practicar c√≥digo por 2 horas ‚ú®" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>üéÄ Prioridad</label>
                                    <select id="taskPriority" required>
                                        <option value="high">üî¥ S√∫per importante!</option>
                                        <option value="medium" selected>üü° Normal</option>
                                        <option value="low">üîµ Cuando pueda</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>üå∏ Categor√≠a</label>
                                    <select id="taskCategory" required>
                                        <option value="beauty">üíÖüèª Beauty</option>
                                        <option value="code">üíª Code</option>
                                        <option value="cafe">‚òï Cafe Time</option>
                                        <option value="study">üìö Study</option>
                                        <option value="workout">üí™üèª Workout</option>
                                        <option value="shopping">üõçÔ∏è Shopping</option>
                                        <option value="otros">üåà Otros</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>üìÖ Fecha l√≠mite</label>
                                    <input type="date" id="taskDeadline">
                                </div>
                                <div class="form-group">
                                    <label>‚è∞ Hora l√≠mite</label>
                                    <input type="time" id="taskTime">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>üîî Recordatorio (minutos antes)</label>
                                    <select id="taskReminder">
                                        <option value="">Sin recordatorio</option>
                                        <option value="5">5 minutos antes</option>
                                        <option value="15">15 minutos antes</option>
                                        <option value="30">30 minutos antes</option>
                                        <option value="60">1 hora antes</option>
                                        <option value="1440">1 d√≠a antes</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label>üìù Notas cute</label>
                                    <textarea id="taskNotes" placeholder="Agrega detalles lindos sobre tu tarea... ‚ú®"></textarea>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                ‚ú® Agregar Tarea ‚ú®
                            </button>
                        </form>
                    </div>

                    <div class="filters">
                        <button class="filter-btn active" onclick="filterTasks('all')">‚ú® Todas</button>
                        <button class="filter-btn" onclick="filterTasks('active')">üí™üèª Activas</button>
                        <button class="filter-btn" onclick="filterTasks('completed')">‚úÖ Completadas</button>
                        <button class="filter-btn" onclick="filterTasks('high')">üî• Importante</button>
                        <button class="filter-btn" onclick="filterTasks('overdue')">‚ö†Ô∏è Vencidas</button>
                    </div>

                    <div id="tasksList" class="tasks-list"></div>
                </div>

                <div id="stats-view" style="display: none;">
                    <div class="form-title">üìä Girly Stats üìä</div>
                    <div class="stats" id="statsContainer"></div>
                    
                    <div class="charts-section">
                        <div class="chart-container">
                            <div class="chart-title">üå∏ Tareas por Categor√≠a üå∏</div>
                            <div class="bar-chart" id="categoryChart"></div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-title">‚ú® Tareas Completadas vs Pendientes ‚ú®</div>
                            <div class="bar-chart" id="statusChart"></div>
                        </div>
                    </div>
                </div>

                <div id="lists-view" style="display: none;">
                    <div class="form-title">üìã Mis Listas Girly üìã</div>
                    
                    <div class="lists-categories">
                        <!-- Alimentos -->
                        <div class="list-category-card">
                            <div class="list-category-header">
                                <span class="list-category-icon">üõí</span>
                                <h3 class="list-category-title">Alimentos</h3>
                            </div>
                            <div class="list-items" id="list-alimentos"></div>
                            <form class="add-item-form" onsubmit="addListItem(event, 'alimentos')">
                                <input type="text" class="add-item-input" placeholder="Agregar item..." required>
                                <button type="submit" class="add-item-btn">+</button>
                            </form>
                        </div>

                        <!-- Farmacia -->
                        <div class="list-category-card">
                            <div class="list-category-header">
                                <span class="list-category-icon">üíä</span>
                                <h3 class="list-category-title">Farmacia</h3>
                            </div>
                            <div class="list-items" id="list-farmacia"></div>
                            <form class="add-item-form" onsubmit="addListItem(event, 'farmacia')">
                                <input type="text" class="add-item-input" placeholder="Agregar item..." required>
                                <button type="submit" class="add-item-btn">+</button>
                            </form>
                        </div>

                        <!-- Beauty/Self care -->
                        <div class="list-category-card">
                            <div class="list-category-header">
                                <span class="list-category-icon">üíÖüèª</span>
                                <h3 class="list-category-title">Beauty/Self care</h3>
                            </div>
                            <div class="list-items" id="list-beauty"></div>
                            <form class="add-item-form" onsubmit="addListItem(event, 'beauty')">
                                <input type="text" class="add-item-input" placeholder="Agregar item..." required>
                                <button type="submit" class="add-item-btn">+</button>
                            </form>
                        </div>

                        <!-- Otros -->
                        <div class="list-category-card">
                            <div class="list-category-header">
                                <span class="list-category-icon">üåà</span>
                                <h3 class="list-category-title">Otros</h3>
                            </div>
                            <div class="list-items" id="list-otros-shopping"></div>
                            <form class="add-item-form" onsubmit="addListItem(event, 'otros-shopping')">
                                <input type="text" class="add-item-input" placeholder="Agregar item..." required>
                                <button type="submit" class="add-item-btn">+</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div id="notebook-view" style="display: none;">
                    <div class="form-title">üìì Mi Cuadernito Girly üìì</div>
                    
                    <div class="notebook-mode-toggle">
                        <button class="mode-btn active" onclick="setNotebookMode('quick')">‚úçÔ∏è Notas R√°pidas</button>
                        <button class="mode-btn" onclick="setNotebookMode('saved')">üíæ Notas Guardadas</button>
                    </div>

                    <div id="quick-notes-mode">
                        <div class="notebook-container">
                            <div class="notebook">
                                <div class="notebook-header">
                                    <div class="notebook-title">‚ú® Mis pensamientos ‚ú®</div>
                                    <div class="notebook-date" id="notebookDate"></div>
                                </div>
                                <div class="notebook-pages">
                                    <textarea 
                                        class="notebook-textarea" 
                                        id="notebookText"
                                        placeholder="Escribe aqu√≠ tus ideas, pensamientos, planes... üí≠‚ú®

Usa este espacio para lo que quieras:
‚Ä¢ Lista de deseos üåü
‚Ä¢ Diario personal üíï
‚Ä¢ Ideas random üí°
‚Ä¢ Mood del d√≠a üå∏
‚Ä¢ Lo que sea! üíñ"></textarea>
                                </div>
                                <div class="notebook-footer">
                                    <div class="word-count" id="wordCount">0 palabras</div>
                                    <div class="notebook-actions">
                                        <button class="btn btn-small btn-edit" onclick="clearNotebook()">üóëÔ∏è Limpiar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="saved-notes-mode" style="display: none;">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <button class="new-note-btn" onclick="createNewNote()">
                                ‚ûï Nueva Nota
                            </button>
                        </div>
                        <div id="notesList" class="notes-list"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let tasks = [];
        let currentFilter = 'all';
        let reminderIntervals = [];
        let savedNotes = [];
        let notebookMode = 'quick';
        let shoppingLists = {
            alimentos: [],
            farmacia: [],
            beauty: [],
            'otros-shopping': []
        };

        // Cargar tareas
        async function loadTasks() {
            try {
                // Primero intentar cargar de localStorage (instant√°neo)
                const localData = localStorage.getItem('kawaii-tasks');
                if (localData) {
                    tasks = JSON.parse(localData);
                    initializeReminders();
                    renderTasks();
                    return;
                }
                
                // Si no hay en localStorage, buscar en window.storage
                const result = await window.storage.get('kawaii-tasks');
                if (result && result.value) {
                    tasks = JSON.parse(result.value);
                    initializeReminders();
                }
            } catch (error) {
                console.log('Nueva lista de tareas kawaii! ‚ú®');
            }
            renderTasks();
        }

        // Guardar tareas
        async function saveTasks() {
            try {
                const data = JSON.stringify(tasks);
                // Guardar instant√°neamente en localStorage (s√≠ncrono)
                localStorage.setItem('kawaii-tasks', data);
                // Tambi√©n guardar en window.storage (as√≠ncrono)
                await window.storage.set('kawaii-tasks', data);
            } catch (error) {
                console.error('Error al guardar:', error);
            }
        }

        // Cargar cuaderno
        async function loadNotebook() {
            try {
                // Primero intentar localStorage
                const localData = localStorage.getItem('girly-notebook');
                if (localData) {
                    document.getElementById('notebookText').value = localData;
                    updateWordCount();
                    return;
                }
                
                // Si no, buscar en window.storage
                const result = await window.storage.get('girly-notebook');
                if (result && result.value) {
                    document.getElementById('notebookText').value = result.value;
                    updateWordCount();
                }
            } catch (error) {
                console.log('Nuevo cuadernito! üìì');
            }
        }

        // Cargar notas guardadas
        async function loadSavedNotes() {
            try {
                // Primero localStorage
                const localData = localStorage.getItem('girly-saved-notes');
                if (localData) {
                    savedNotes = JSON.parse(localData);
                    renderSavedNotes();
                    return;
                }
                
                // Si no, window.storage
                const result = await window.storage.get('girly-saved-notes');
                if (result && result.value) {
                    savedNotes = JSON.parse(result.value);
                }
            } catch (error) {
                console.log('Nuevas notas guardadas! üíï');
            }
            renderSavedNotes();
        }

        // Guardar cuaderno
        async function saveNotebook() {
            try {
                const text = document.getElementById('notebookText').value;
                // Guardar instant√°neamente en localStorage
                localStorage.setItem('girly-notebook', text);
                // Tambi√©n en window.storage
                await window.storage.set('girly-notebook', text);
            } catch (error) {
                console.error('Error al guardar:', error);
            }
        }

        // Guardar notas guardadas
        async function saveSavedNotes() {
            try {
                const data = JSON.stringify(savedNotes);
                // localStorage instant√°neo
                localStorage.setItem('girly-saved-notes', data);
                // window.storage as√≠ncrono
                await window.storage.set('girly-saved-notes', data);
            } catch (error) {
                console.error('Error al guardar notas:', error);
            }
        }

        // Cargar listas de compras
        async function loadShoppingLists() {
            try {
                // Primero localStorage
                const localData = localStorage.getItem('girly-shopping-lists');
                if (localData) {
                    shoppingLists = JSON.parse(localData);
                    renderAllLists();
                    return;
                }
                
                // Si no, window.storage
                const result = await window.storage.get('girly-shopping-lists');
                if (result && result.value) {
                    shoppingLists = JSON.parse(result.value);
                }
            } catch (error) {
                console.log('Nuevas listas! üõí');
            }
            renderAllLists();
        }

        // Guardar listas de compras
        async function saveShoppingLists() {
            try {
                const data = JSON.stringify(shoppingLists);
                // localStorage instant√°neo
                localStorage.setItem('girly-shopping-lists', data);
                // window.storage as√≠ncrono
                await window.storage.set('girly-shopping-lists', data);
            } catch (error) {
                console.error('Error al guardar listas:', error);
            }
        }

        // Agregar item a lista
        function addListItem(event, category) {
            event.preventDefault();
            const input = event.target.querySelector('.add-item-input');
            const text = input.value.trim();
            
            if (text) {
                const item = {
                    id: Date.now(),
                    text: text,
                    checked: false
                };
                
                shoppingLists[category].push(item);
                saveShoppingLists();
                renderList(category);
                input.value = '';
            }
        }

        // Toggle item checked
        function toggleListItem(category, itemId) {
            const item = shoppingLists[category].find(i => i.id === itemId);
            if (item) {
                item.checked = !item.checked;
                saveShoppingLists();
                renderList(category);
            }
        }

        // Eliminar item
        function deleteListItem(category, itemId) {
            shoppingLists[category] = shoppingLists[category].filter(i => i.id !== itemId);
            saveShoppingLists();
            renderList(category);
        }

        // Renderizar una lista espec√≠fica
        function renderList(category) {
            const container = document.getElementById(`list-${category}`);
            const items = shoppingLists[category];
            
            if (items.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #ffb3d9; padding: 20px; font-size: 0.9em;">No hay items a√∫n üíï</div>';
                return;
            }
            
            container.innerHTML = items.map(item => `
                <div class="list-item ${item.checked ? 'checked' : ''}">
                    <input type="checkbox" 
                           class="list-item-checkbox" 
                           ${item.checked ? 'checked' : ''}
                           onchange="toggleListItem('${category}', ${item.id})">
                    <span class="list-item-text">${item.text}</span>
                    <button class="list-item-delete" onclick="deleteListItem('${category}', ${item.id})">üóëÔ∏è</button>
                </div>
            `).join('');
        }

        // Renderizar todas las listas
        function renderAllLists() {
            Object.keys(shoppingLists).forEach(category => {
                renderList(category);
            });
        }

        // Sistema de recordatorios
        function initializeReminders() {
            // Limpiar intervalos anteriores
            reminderIntervals.forEach(interval => clearInterval(interval));
            reminderIntervals = [];

            // Verificar recordatorios cada minuto
            const checkInterval = setInterval(() => {
                checkReminders();
            }, 60000); // 60000ms = 1 minuto

            reminderIntervals.push(checkInterval);
            
            // Verificar al cargar
            checkReminders();
        }

        function checkReminders() {
            const now = new Date();
            
            tasks.forEach(task => {
                if (task.completed || !task.deadline || !task.reminder) return;
                
                const deadline = new Date(task.deadline);
                if (task.time) {
                    const [hours, minutes] = task.time.split(':');
                    deadline.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                }
                
                const reminderTime = new Date(deadline.getTime() - (parseInt(task.reminder) * 60000));
                
                // Si estamos dentro de 1 minuto del tiempo de recordatorio y no se ha mostrado
                const timeDiff = Math.abs(now - reminderTime);
                if (timeDiff < 60000 && !task.reminderShown) {
                    showNotification(`üîî Recordatorio: ${task.title}`, `¬°Tu tarea es en ${task.reminder} minutos! ‚ú®`);
                    task.reminderShown = true;
                    saveTasks();
                }
            });
        }

        function showNotification(title, message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
                <div style="font-size: 1.2em; margin-bottom: 5px;">${title}</div>
                <div>${message}</div>
            `;
            document.body.appendChild(notification);

            // Reproducir sonido (opcional)
            try {
                const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSl+zPLTgjMGHm7A7+OZUQ0PVqzn77BdGQg+ltryxnMoBSh8yfDZiTYIGGS67OaVTwwOUqvj5rJfGQc9k9nxw3ElBSZ6yPDXhTMHHGy+6+GVUAoPU6rk5LFfGgc+lNrww3AoBSd6x/DYhTEHG2u96+GWUg0PUqrk4rBfGgc9k9rxw3AoBSZ7x/HYhDIHHGy96d+UUA0QUqnj47JgGgc9k9rxw3IpBSV6yPDYhTMHHWu96+GVTwwPUavk5LBfGQc+kdnxxHEnBSZ5yPDXhzMHHWy/7+GVUQ0OUavl5rBfGQc9k9nww3IpBSV6yPDXhTMHHGy+6+GWTwwOUqrk5LFfGgc9k9rxw28oBSZ7x/HXhTMHHGu/6+GWUQ0OU6rk4rBfGgc+k9nxxHApBSZ6yPDXhDIGG2y+7N+XUAwPUqnk47JgGgg+lNrwwnEoBSR6yPHYhjQHG2y+7eOYUg0PU6rj4rBgGgg+lNrxwnEoBSV5x/HYhzMHGmy/7eKYUQ0PUqnk4bNgGgg9ldrwwnApBSV6x/HYhjMHG2y+7eKZUAwPUqnj4rNfGgg+lNnww3EoBSV6x/HYhzQHGmy97+KYUQ4PUank47BgGgk9lNrww3EoBSV5yPHXhjMHGmy/7eKZUQwPUqrj4rNgGgg+lNnww3EoBSZ6x/DYhzMHG2u/7eKZUA0PUqrk47BgGgg+ldvxw28oBSZ6yPDXhjMHGmu/7+KYUQ0PUqvk4rBhGgg9ldnxw3AoBSZ5x/HYhjMHGmy/7+KZUQ4PUani4rJhGwg9lNnxxHAoBSZ5yPDWhjMGG2y+7+GZUA4PUqri4rJhGgk9lNnxxHAoBSZ6x/HXhjMGHGy96+CYTw0PU6nl5LJhGgk9ldrww3AoBSZ6x/HXhTIGHGy/7N+YUQ0PUqrk5LBgGgk9ldvxxHApBCV6yPDXhTMGG2y/7N+YUQ0PUqrk47BgGgg9ldrxxHApBSZ5x/HYhTMHG2y/7d+XTw0PU6zl47FfGgk9ldvwxHApBSZ6x/HXhzMGHGy/7N+YUg0PU6nl5LBhGgk9lNvwxHApBCV6x/HXhzMHG2y97N+YUQ0PU6nl47BiGgg9lNrwxHApBCV6yPHYhTIGHGy/7eGYUAwPU6zl5LJgGgc9ldnxxHAoBSZ6x/HXhjMGG2y/7OCYUQ0PVKnj47BiGwg9ldrwxHAoBCV6x/HYhzMHGmy/7d+XUQ4OUqrl5LJgGgo9lNvwxHApBCZ6yPHXhjMHGmy/7d+YUQ4OUqrl47BhGgk9lNnxxG8pBCZ6x/HYhzQHGmy/7OCXUg4OUqvk5LFgGgg+ldvwxHApBCZ6yPHXhjMHGmzA7d+YUQ4NU6rk47FhGgo9lNvwxHApBSV6x/HXhzMHGmy/7OCYUQ0PUqvk5LBgGgg+lNvwxHEoBCV6x/HXhTMHG2y/7OCZUA0PU6vl5bBgGwg9lNvwxHEoBCZ5x/DYhjMHHGy/7OCZUg0PVKnk47NhGgg9ldvwxHApBSV6x/HXhTMHGm0A7d+ZUQ0PVKnj5LFgGgk9ltnww3EoBCZ6x/DXhzMHGmy+7d+YUg0PU6vk47BgGgg+ldvwxHEpBCV6x/HXhjMHGmy+7eCZUg0PU6vk5LBgGgg9ldvxw3EoBCZ6x/HXhjMHG2y/7OCZUQ4PU6rk4rFgGgk+lNrwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEoBCZ6x/DXhjMHG2y/7OCZUQ4PU6rk4rBgGgk+ldvwxHEo=');
                audio.play().catch(() => {});
            } catch (e) {}

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.5s ease-out';
                setTimeout(() => {
                    notification.remove();
                }, 500);
            }, 5000);
        }

        // Formulario
        document.getElementById('taskForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const task = {
                id: Date.now(),
                title: document.getElementById('taskTitle').value,
                priority: document.getElementById('taskPriority').value,
                category: document.getElementById('taskCategory').value,
                deadline: document.getElementById('taskDeadline').value,
                time: document.getElementById('taskTime').value,
                reminder: document.getElementById('taskReminder').value,
                notes: document.getElementById('taskNotes').value,
                completed: false,
                reminderShown: false,
                createdAt: new Date().toISOString()
            };

            tasks.unshift(task);
            await saveTasks();
            initializeReminders();
            renderTasks();
            
            this.reset();
            
            showNotification('‚ú® ¬°Tarea agregada!', 'Tu nueva tarea est√° lista üíñ');
        });

        // Renderizar tareas
        function renderTasks() {
            const container = document.getElementById('tasksList');
            
            let filteredTasks = tasks;
            
            if (currentFilter === 'active') {
                filteredTasks = tasks.filter(t => !t.completed);
            } else if (currentFilter === 'completed') {
                filteredTasks = tasks.filter(t => t.completed);
            } else if (currentFilter === 'high') {
                filteredTasks = tasks.filter(t => t.priority === 'high' && !t.completed);
            } else if (currentFilter === 'overdue') {
                const now = new Date();
                filteredTasks = tasks.filter(t => {
                    if (!t.deadline || t.completed) return false;
                    const deadline = new Date(t.deadline);
                    if (t.time) {
                        const [hours, minutes] = t.time.split(':');
                        deadline.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                    }
                    return deadline < now;
                });
            }

            if (filteredTasks.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üå∏</div>
                        <h3>¬°Todo limpio y organizado! ‚ú®</h3>
                        <p>${currentFilter === 'all' ? 'Agrega tu primera tarea üíï' : 'No hay tareas aqu√≠ todav√≠a'}</p>
                    </div>
                `;
                return;
            }

            const categoryIcons = {
                beauty: 'üíÖüèª',
                code: 'üíª',
                cafe: '‚òï',
                study: 'üìö',
                workout: 'üí™üèª',
                shopping: 'üõçÔ∏è',
                otros: 'üåà'
            };

            const categoryLabels = {
                beauty: 'Beauty',
                code: 'Code',
                cafe: 'Cafe Time',
                study: 'Study',
                workout: 'Workout',
                shopping: 'Shopping',
                otros: 'Otros'
            };

            const priorityLabels = {
                high: 'üî¥ S√∫per importante',
                medium: 'üü° Normal',
                low: 'üîµ Cuando pueda'
            };

            container.innerHTML = filteredTasks.map(task => {
                let deadlineHtml = '';
                if (task.deadline) {
                    const deadline = new Date(task.deadline);
                    if (task.time) {
                        const [hours, minutes] = task.time.split(':');
                        deadline.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                    }
                    const now = new Date();
                    const isOverdue = deadline < now && !task.completed;
                    const dateStr = deadline.toLocaleDateString('es-ES', { 
                        day: 'numeric', 
                        month: 'short', 
                        year: 'numeric' 
                    });
                    const timeStr = task.time ? ` ${task.time}` : '';
                    
                    deadlineHtml = `<span class="badge badge-deadline ${isOverdue ? 'overdue' : ''}">
                        üìÖ ${dateStr}${timeStr}${isOverdue ? ' ‚ö†Ô∏è' : ''}
                    </span>`;
                }

                let reminderHtml = '';
                if (task.reminder && !task.completed) {
                    const reminderLabels = {
                        '5': '5 min',
                        '15': '15 min',
                        '30': '30 min',
                        '60': '1 hora',
                        '1440': '1 d√≠a'
                    };
                    reminderHtml = `<span class="badge badge-reminder">
                        üîî ${reminderLabels[task.reminder]} antes
                    </span>`;
                }

                return `
                    <div class="task-card ${task.completed ? 'completed' : ''} category-${task.category}">
                        <div class="task-header">
                            <input type="checkbox" 
                                   class="task-checkbox" 
                                   ${task.completed ? 'checked' : ''}
                                   onchange="toggleTask(${task.id})">
                            <div class="task-content">
                                <div class="task-title">${task.title}</div>
                                <div class="task-meta">
                                    <span class="badge badge-${task.priority}">${priorityLabels[task.priority]}</span>
                                    <span class="badge badge-category">${categoryIcons[task.category]} ${categoryLabels[task.category]}</span>
                                    ${deadlineHtml}
                                    ${reminderHtml}
                                </div>
                                ${task.notes ? `<div class="task-notes">üí≠ ${task.notes}</div>` : ''}
                                <div class="task-actions">
                                    <button class="btn btn-small btn-edit" onclick="editTask(${task.id})">‚úèÔ∏è Editar</button>
                                    <button class="btn btn-small btn-delete" onclick="deleteTask(${task.id})">üóëÔ∏è Eliminar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        async function toggleTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.completed = !task.completed;
                await saveTasks();
                renderTasks();
                
                if (task.completed) {
                    showNotification('‚ú® ¬°Completada!', '¬°Bien hecho! üíñ');
                }
            }
        }

        async function deleteTask(id) {
            if (confirm('¬øSegura que quieres eliminar esta tarea? ü•∫')) {
                tasks = tasks.filter(t => t.id !== id);
                await saveTasks();
                renderTasks();
                showNotification('üóëÔ∏è Tarea eliminada', 'Se elimin√≥ correctamente');
            }
        }

        function editTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                document.getElementById('taskTitle').value = task.title;
                document.getElementById('taskPriority').value = task.priority;
                document.getElementById('taskCategory').value = task.category;
                document.getElementById('taskDeadline').value = task.deadline;
                document.getElementById('taskTime').value = task.time;
                document.getElementById('taskReminder').value = task.reminder;
                document.getElementById('taskNotes').value = task.notes;
                
                deleteTask(id);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function filterTasks(filter) {
            currentFilter = filter;
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderTasks();
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            // Hide all views
            document.getElementById('tasks-view').style.display = 'none';
            document.getElementById('lists-view').style.display = 'none';
            document.getElementById('notebook-view').style.display = 'none';
            document.getElementById('stats-view').style.display = 'none';
            
            if (tab === 'tasks') {
                document.getElementById('tasks-view').style.display = 'block';
            } else if (tab === 'lists') {
                document.getElementById('lists-view').style.display = 'block';
                loadShoppingLists();
            } else if (tab === 'notebook') {
                document.getElementById('notebook-view').style.display = 'block';
                updateNotebookDate();
                loadNotebook();
                loadSavedNotes();
            } else if (tab === 'stats') {
                document.getElementById('stats-view').style.display = 'block';
                renderStats();
            }
        }

        // Funciones del cuaderno
        function updateNotebookDate() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('es-ES', { 
                weekday: 'long',
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            document.getElementById('notebookDate').textContent = dateStr;
        }

        function updateWordCount() {
            const text = document.getElementById('notebookText').value;
            const words = text.trim().split(/\s+/).filter(word => word.length > 0).length;
            document.getElementById('wordCount').textContent = `${words} palabra${words !== 1 ? 's' : ''}`;
        }

        function clearNotebook() {
            if (confirm('¬øSegura que quieres limpiar todo el cuaderno? ü•∫')) {
                document.getElementById('notebookText').value = '';
                updateWordCount();
                saveNotebook();
            }
        }

        function setNotebookMode(mode) {
            notebookMode = mode;
            
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            if (mode === 'quick') {
                document.getElementById('quick-notes-mode').style.display = 'block';
                document.getElementById('saved-notes-mode').style.display = 'none';
            } else {
                document.getElementById('quick-notes-mode').style.display = 'none';
                document.getElementById('saved-notes-mode').style.display = 'block';
                renderSavedNotes();
            }
        }

        function createNewNote() {
            const note = {
                id: Date.now(),
                title: '',
                content: '',
                date: new Date().toISOString()
            };
            savedNotes.unshift(note);
            saveSavedNotes();
            renderSavedNotes();
        }

        function renderSavedNotes() {
            const container = document.getElementById('notesList');
            
            if (savedNotes.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        <h3>No tienes notas guardadas a√∫n</h3>
                        <p>¬°Crea tu primera nota para empezar! üíï</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = savedNotes.map(note => {
                const date = new Date(note.date);
                const dateStr = date.toLocaleDateString('es-ES', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                return `
                    <div class="note-card">
                        <div class="note-card-header">
                            <div class="note-date">${dateStr}</div>
                            <input 
                                type="text" 
                                class="note-title-input" 
                                value="${note.title}" 
                                placeholder="T√≠tulo de la nota..." 
                                onchange="updateNoteTitle(${note.id}, this.value)"
                                onblur="updateNoteTitle(${note.id}, this.value)">
                        </div>
                        <div class="note-content" 
                             contenteditable="true" 
                             onfocus="if(this.innerText.includes('Escribe tu nota aqu√≠')) this.innerText=''"
                             onblur="updateNoteContent(${note.id}, this.innerText)"
                             data-placeholder="Escribe tu nota aqu√≠... üí≠">${note.content || ''}</div>
                        <div class="note-actions-bar">
                            <button class="btn btn-small btn-delete" onclick="deleteNote(${note.id})">üóëÔ∏è Eliminar</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateNoteTitle(id, title) {
            const note = savedNotes.find(n => n.id === id);
            if (note) {
                note.title = title;
                saveSavedNotes();
            }
        }

        function updateNoteContent(id, content) {
            const note = savedNotes.find(n => n.id === id);
            if (note) {
                note.content = content;
                saveSavedNotes();
            }
        }

        function deleteNote(id) {
            if (confirm('¬øSegura que quieres eliminar esta nota? ü•∫')) {
                savedNotes = savedNotes.filter(n => n.id !== id);
                saveSavedNotes();
                renderSavedNotes();
            }
        }

        function renderStats() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const active = total - completed;
            const highPriority = tasks.filter(t => t.priority === 'high' && !t.completed).length;
            
            const now = new Date();
            const overdue = tasks.filter(t => {
                if (!t.deadline || t.completed) return false;
                const deadline = new Date(t.deadline);
                if (t.time) {
                    const [hours, minutes] = t.time.split(':');
                    deadline.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                }
                return deadline < now;
            }).length;

            const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;

            // Contar por categor√≠a
            const byCategory = {
                beauty: tasks.filter(t => t.category === 'beauty' && !t.completed).length,
                code: tasks.filter(t => t.category === 'code' && !t.completed).length,
                cafe: tasks.filter(t => t.category === 'cafe' && !t.completed).length,
            };

            document.getElementById('statsContainer').innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${total}</div>
                    <div class="stat-label">‚ú® Total de Tareas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${active}</div>
                    <div class="stat-label">üí™üèª Tareas Activas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${completed}</div>
                    <div class="stat-label">‚úÖ Completadas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${completionRate}%</div>
                    <div class="stat-label">üíñ Progreso</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${highPriority}</div>
                    <div class="stat-label">üî• Prioridad Alta</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${overdue}</div>
                    <div class="stat-label">‚ö†Ô∏è Vencidas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${byCategory.beauty}</div>
                    <div class="stat-label">üíÖüèª Beauty Tasks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${byCategory.code}</div>
                    <div class="stat-label">üíª Code Tasks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${byCategory.cafe}</div>
                    <div class="stat-label">‚òï Cafe Tasks</div>
                </div>
            `;

            // Renderizar gr√°ficos de barras
            renderCategoryChart();
            renderStatusChart();
        }

        function renderCategoryChart() {
            const categoryData = {
                beauty: { count: tasks.filter(t => t.category === 'beauty').length, label: 'üíÖüèª Beauty', class: 'beauty' },
                code: { count: tasks.filter(t => t.category === 'code').length, label: 'üíª Code', class: 'code' },
                cafe: { count: tasks.filter(t => t.category === 'cafe').length, label: '‚òï Cafe Time', class: 'cafe' },
                study: { count: tasks.filter(t => t.category === 'study').length, label: 'üìö Study', class: 'study' },
                workout: { count: tasks.filter(t => t.category === 'workout').length, label: 'üí™üèª Workout', class: 'workout' },
                shopping: { count: tasks.filter(t => t.category === 'shopping').length, label: 'üõçÔ∏è Shopping', class: 'shopping' },
                otros: { count: tasks.filter(t => t.category === 'otros').length, label: 'üåà Otros', class: 'otros' }
            };

            const maxCount = Math.max(...Object.values(categoryData).map(d => d.count), 1);
            const chartContainer = document.getElementById('categoryChart');

            chartContainer.innerHTML = Object.entries(categoryData).map(([key, data]) => {
                const percentage = maxCount > 0 ? (data.count / maxCount) * 100 : 0;
                return `
                    <div class="bar-item">
                        <div class="bar-label">${data.label}</div>
                        <div class="bar-wrapper">
                            <div class="bar-fill bar-${data.class}" style="width: ${percentage}%; animation: barGrow 1s ease-out;">
                                ${data.count > 0 ? data.count : ''}
                            </div>
                        </div>
                        <div class="bar-value">${data.count}</div>
                    </div>
                `;
            }).join('');
        }

        function renderStatusChart() {
            const completed = tasks.filter(t => t.completed).length;
            const active = tasks.filter(t => !t.completed).length;
            const total = tasks.length;

            const chartContainer = document.getElementById('statusChart');

            const completedPercentage = total > 0 ? (completed / total) * 100 : 0;
            const activePercentage = total > 0 ? (active / total) * 100 : 0;

            chartContainer.innerHTML = `
                <div class="bar-item">
                    <div class="bar-label">‚úÖ Completadas</div>
                    <div class="bar-wrapper">
                        <div class="bar-fill bar-beauty" style="width: ${completedPercentage}%; animation: barGrow 1s ease-out;">
                            ${completed > 0 ? completed : ''}
                        </div>
                    </div>
                    <div class="bar-value">${completed}</div>
                </div>
                <div class="bar-item">
                    <div class="bar-label">üí™üèª Pendientes</div>
                    <div class="bar-wrapper">
                        <div class="bar-fill bar-code" style="width: ${activePercentage}%; animation: barGrow 1s ease-out;">
                            ${active > 0 ? active : ''}
                        </div>
                    </div>
                    <div class="bar-value">${active}</div>
                </div>
            `;
        }

        document.getElementById('taskDeadline').min = new Date().toISOString().split('T')[0];

        // Inicializar - Cargar TODO antes de mostrar la app
        async function initializeApp() {
            try {
                // Mostrar loader
                const loader = document.getElementById('appLoader');
                
                // Cargar todas las cosas en paralelo para que sea m√°s r√°pido
                await Promise.all([
                    loadTasks(),
                    loadNotebook(),
                    loadSavedNotes(),
                    loadShoppingLists()
                ]);
                
                // Configurar auto-save del cuaderno
                const notebookText = document.getElementById('notebookText');
                if (notebookText) {
                    notebookText.addEventListener('input', function() {
                        updateWordCount();
                        saveNotebook();
                    });
                }
                
                // Guardar TODO antes de cerrar/salir
                const saveAllData = async () => {
                    try {
                        await Promise.all([
                            saveTasks(),
                            saveNotebook(),
                            saveSavedNotes(),
                            saveShoppingLists()
                        ]);
                        console.log('üíæ Datos guardados antes de cerrar');
                    } catch (error) {
                        console.error('Error al guardar antes de cerrar:', error);
                    }
                };
                
                // Cuando el usuario sale de la app (bot√≥n atr√°s, cerrar, etc)
                window.addEventListener('beforeunload', (e) => {
                    saveAllData();
                });
                
                // Cuando la app pasa a segundo plano o se oculta
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden) {
                        saveAllData();
                    }
                });
                
                // Cuando pierde el foco (Android)
                window.addEventListener('blur', () => {
                    saveAllData();
                });
                
                // Auto-save peri√≥dico cada 2 segundos (backup por si acaso)
                setInterval(() => {
                    saveAllData();
                }, 2000);
                
                // Dar un ratito para que todo se renderice
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // Ocultar loader con animaci√≥n
                loader.classList.add('hidden');
                
                // Despu√©s de la animaci√≥n, removerlo completamente
                setTimeout(() => {
                    loader.style.display = 'none';
                }, 300);
                
                console.log('‚ú® App cargada completamente!');
            } catch (error) {
                console.error('Error al inicializar:', error);
                // Incluso si hay error, ocultar el loader
                document.getElementById('appLoader').style.display = 'none';
            }
        }

        // Iniciar cuando el DOM est√© listo
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
    </script>

    <!-- PWA Service Worker Registration -->
    <script>
        // Registrar Service Worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('‚ú® Service Worker registrado exitosamente:', registration.scope);
                    })
                    .catch(error => {
                        console.log('‚ùå Error al registrar Service Worker:', error);
                    });
            });
        }

        // Detectar cuando la app puede instalarse (solo en m√≥viles/Chrome)
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevenir que Chrome muestre el prompt autom√°ticamente
            e.preventDefault();
            deferredPrompt = e;
            
            // Mostrar un mensaje cute para instalar
            setTimeout(() => {
                if (confirm('üíñ ¬øQuer√©s instalar "My girly routine" en tu pantalla de inicio para acceso r√°pido? ‚ú®')) {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('‚ú® App instalada!');
                        }
                        deferredPrompt = null;
                    });
                }
            }, 3000); // Espera 3 segundos antes de preguntar
        });

        // Cuando la app ya est√° instalada
        window.addEventListener('appinstalled', () => {
            console.log('üíñ ¬°App instalada exitosamente!');
        });
    </script>
</body>
</html>
